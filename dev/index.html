<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Sophon.jl</title><meta name="title" content="Home · Sophon.jl"/><meta property="og:title" content="Home · Sophon.jl"/><meta property="twitter:title" content="Home · Sophon.jl"/><meta name="description" content="Documentation for Sophon.jl."/><meta property="og:description" content="Documentation for Sophon.jl."/><meta property="twitter:description" content="Documentation for Sophon.jl."/><meta property="og:url" content="https://YichengDWu.github.io/Sophon.jl/"/><meta property="twitter:url" content="https://YichengDWu.github.io/Sophon.jl/"/><link rel="canonical" href="https://YichengDWu.github.io/Sophon.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Sophon.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Step-1:-Import-the-required-packages"><span>Step 1: Import the required packages</span></a></li><li><a class="tocitem" href="#Step-2:-Define-the-PDE-system"><span>Step 2: Define the PDE system</span></a></li><li><a class="tocitem" href="#Step-3:-Define-the-neural-network-architecture"><span>Step 3: Define the neural network architecture</span></a></li><li><a class="tocitem" href="#Step-4:-Create-a-QuasiRandomSampler-object"><span>Step 4: Create a QuasiRandomSampler object</span></a></li><li><a class="tocitem" href="#Step-5:-Define-a-training-strategy"><span>Step 5: Define a training strategy</span></a></li><li><a class="tocitem" href="#Step-6:-Discretize-the-PDE-system-using-Sophon"><span>Step 6: Discretize the PDE system using Sophon</span></a></li><li><a class="tocitem" href="#Step-7:-Solve-the-optimization-problem"><span>Step 7: Solve the optimization problem</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="tutorials/ode/">Introduction with Lotka-Volterra System</a></li><li><a class="tocitem" href="tutorials/discontinuous/">Fitting a nonlinear discontinuous function</a></li><li><a class="tocitem" href="tutorials/poisson/">1D Multi-scale Poisson&#39;s Equation</a></li><li><a class="tocitem" href="tutorials/convection/">1D Convection Equation</a></li><li><a class="tocitem" href="tutorials/helmholtz/">2D Helmholtz Equation</a></li><li><a class="tocitem" href="tutorials/allen_cahn/">Allen-Cahn Equation with Sequential Training</a></li><li><a class="tocitem" href="tutorials/SchrödingerEquation/">Schrödinger Equation: A PDE System with Resampling</a></li><li><a class="tocitem" href="tutorials/L_shape/">Poisson equation over an L-shaped domain</a></li><li><a class="tocitem" href="tutorials/waveinverse2/">Inverse problem for the wave equation with unknown velocity field</a></li><li><a class="tocitem" href="tutorials/sod/">SOD Shock Tube Problem</a></li></ul></li><li><a class="tocitem" href="qa/">FAQ</a></li><li><a class="tocitem" href="api/">API Reference</a></li><li><a class="tocitem" href="references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/YichengDWu/Sophon.jl/blob/main/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Sophon"><a class="docs-heading-anchor" href="#Sophon">Sophon</a><a id="Sophon-1"></a><a class="docs-heading-anchor-permalink" href="#Sophon" title="Permalink"></a></h1><p>Sophon.jl is a Julia package for solving partial differential equations (PDEs) using physics-informed neural networks (PINNs). We will go through the steps to solve the nonlinear Schrödinger equation using Sophon.jl.</p><h2 id="Step-1:-Import-the-required-packages"><a class="docs-heading-anchor" href="#Step-1:-Import-the-required-packages">Step 1: Import the required packages</a><a id="Step-1:-Import-the-required-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Import-the-required-packages" title="Permalink"></a></h2><pre><code class="language-julia hljs">using ModelingToolkit, IntervalSets, Sophon, CairoMakie
using Optimization, OptimizationOptimJL</code></pre><h2 id="Step-2:-Define-the-PDE-system"><a class="docs-heading-anchor" href="#Step-2:-Define-the-PDE-system">Step 2: Define the PDE system</a><a id="Step-2:-Define-the-PDE-system-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Define-the-PDE-system" title="Permalink"></a></h2><p>In this step, we define the PDE system for the nonlinear Schrödinger equation using ModelingToolkit.jl.</p><pre><code class="language-julia hljs">@parameters x,t
@variables u(..), v(..)
Dₜ = Differential(t)
Dₓ² = Differential(x)^2

eqs=[Dₜ(u(x,t)) ~ -Dₓ²(v(x,t))/2 - (abs2(v(x,t)) + abs2(u(x,t))) * v(x,t),
     Dₜ(v(x,t)) ~  Dₓ²(u(x,t))/2 + (abs2(v(x,t)) + abs2(u(x,t))) * u(x,t)]

bcs = [u(x, 0.0) ~ 2sech(x),
       v(x, 0.0) ~ 0.0,
       u(-5.0, t) ~ u(5.0, t),
       v(-5.0, t) ~ v(5.0, t)]

domains = [x ∈ Interval(-5.0, 5.0),
           t ∈ Interval(0.0, π/2)]

@named pde_system = PDESystem(eqs, bcs, domains, [x,t], [u(x,t),v(x,t)])</code></pre><p>The <code>@parameters</code> macro defines the parameters of the PDE system, and the <code>@variables</code> macro defines the dependent variables. We use <code>Differential</code> to define the derivatives with respect to time and space. The <code>eqs</code> array defines the equations in the PDE system. The bcs array defines the boundary conditions. The <code>domains</code> array defines the spatial and temporal domains of the PDE system. Finally, we use the <code>@named</code> macro to give a name to the PDE system.</p><h2 id="Step-3:-Define-the-neural-network-architecture"><a class="docs-heading-anchor" href="#Step-3:-Define-the-neural-network-architecture">Step 3: Define the neural network architecture</a><a id="Step-3:-Define-the-neural-network-architecture-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Define-the-neural-network-architecture" title="Permalink"></a></h2><p>Next, we define the physics-informed neural network (PINN) using Sophon.jl. In this example, we will use a Siren network with 2 sine layers and 1 cosine layer for each variable, and 16 hidden dimensions per layer. We will use 4 layers for both variables, and set the frequency parameter <span>$\omega$</span> to 1.0.</p><pre><code class="language-julia hljs">pinn = PINN(u = Siren(2,1; hidden_dims=16,num_layers=4, omega = 1.0),
            v = Siren(2,1; hidden_dims=16,num_layers=4, omega = 1.0))            </code></pre><p>We define a physics-informed neural network (PINN) with the pinn variable. The PINN macro takes a dictionary that maps the dependent variables to their corresponding neural network architecture. In this case, we use the Siren architecture for both u and v with 2 input dimensions, 1 output dimension, 16 hidden dimensions, and 4 layers. We also set the frequency of the sine activation functions to 1.0.</p><h2 id="Step-4:-Create-a-QuasiRandomSampler-object"><a class="docs-heading-anchor" href="#Step-4:-Create-a-QuasiRandomSampler-object">Step 4: Create a QuasiRandomSampler object</a><a id="Step-4:-Create-a-QuasiRandomSampler-object-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4:-Create-a-QuasiRandomSampler-object" title="Permalink"></a></h2><p>Here, we create a QuasiRandomSampler object with 500 sample points, where the first argument corresponds to the number of data points for each equation, and the second  argument corresponds to the number of data points for each boundary condition.</p><pre><code class="language-julia hljs">sampler = QuasiRandomSampler(500, (200,200,20,20))</code></pre><h2 id="Step-5:-Define-a-training-strategy"><a class="docs-heading-anchor" href="#Step-5:-Define-a-training-strategy">Step 5: Define a training strategy</a><a id="Step-5:-Define-a-training-strategy-1"></a><a class="docs-heading-anchor-permalink" href="#Step-5:-Define-a-training-strategy" title="Permalink"></a></h2><p>Here, we use a NonAdaptiveTraining strategy with <code>1</code> as the weight of all equations, and <code>(10,10,1,1)</code> for the four boundary conditions.</p><pre><code class="language-julia hljs">strategy = NonAdaptiveTraining(1,(10,10,1,1))</code></pre><h2 id="Step-6:-Discretize-the-PDE-system-using-Sophon"><a class="docs-heading-anchor" href="#Step-6:-Discretize-the-PDE-system-using-Sophon">Step 6: Discretize the PDE system using Sophon</a><a id="Step-6:-Discretize-the-PDE-system-using-Sophon-1"></a><a class="docs-heading-anchor-permalink" href="#Step-6:-Discretize-the-PDE-system-using-Sophon" title="Permalink"></a></h2><pre><code class="language-julia hljs">prob = Sophon.discretize(pde_system, pinn, sampler, strategy)</code></pre><h2 id="Step-7:-Solve-the-optimization-problem"><a class="docs-heading-anchor" href="#Step-7:-Solve-the-optimization-problem">Step 7: Solve the optimization problem</a><a id="Step-7:-Solve-the-optimization-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Step-7:-Solve-the-optimization-problem" title="Permalink"></a></h2><pre><code class="language-julia hljs">res = Optimization.solve(prob, BFGS(); maxiters=2000)</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="tutorials/ode/">Introduction with Lotka-Volterra System »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Saturday 6 January 2024 09:04">Saturday 6 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
